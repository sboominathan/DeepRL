import numpy as np

action_distributions = [

{0: 0.12630747977106768, 1: 0.5365107558713242, 2: 0.15591079534241167, 3: 0.18127096901519638},
{0: 0.1204807599108268, 1: 0.4943297470194824, 2: 0.17650479790636814, 3: 0.20868469516332266},
{0: 0.10167522029631064, 1: 0.5073109325070204, 2: 0.1788515541783674, 3: 0.21216229301830153},
{0: 0.0998997995991984, 1: 0.49509018036072144, 2: 0.1882765531062124, 3: 0.21673346693386775},
{0: 0.12992455993294216, 1: 0.48765949520350194, 2: 0.1759336872496973, 3: 0.20648225761385863},
{0: 0.09472196041470311, 1: 0.5170593779453346, 2: 0.17737983034872762, 3: 0.21083883129123468},
{0: 0.1335775819388058, 1: 0.4539063273591445, 2: 0.19338548371125855, 3: 0.21913060699079118},
{0: 0.10089261563429808, 1: 0.4906681092777928, 2: 0.18979352628257146, 3: 0.21864574880533766},
{0: 0.11855918328036213, 1: 0.5067899451025715, 2: 0.17634595011075796, 3: 0.19830492150630838},
{0: 0.08735968765251342, 1: 0.5613469985358711, 2: 0.15841874084919472, 3: 0.1928745729624207},
{0: 0.11956224350205198, 1: 0.5107159142726858, 2: 0.17720018239854082, 3: 0.1925216598267214},
{0: 0.09372461413484971, 1: 0.5334077985377742, 2: 0.1792242079610073, 3: 0.1936433793663688},
{0: 0.10277082754146974, 1: 0.509869335557409, 2: 0.18533963488091929, 3: 0.20202020202020202},
{0: 0.15046098279631215, 1: 0.4845547001235624, 2: 0.17137154262902765, 3: 0.1936127744510978},
{0: 0.12074365969485702, 1: 0.48438920885116704, 2: 0.185712842275437, 3: 0.20915428917853895},
{0: 0.12630747977106768, 1: 0.5365107558713242, 2: 0.15591079534241167, 3: 0.18127096901519638},

]

avg_distributions = [

[ 0.181507838047214,  0.22577147949603169,  0.31330311713103026,  0.27941756532572415],
[ 0.2280616172667789,  0.09853159955431767,  0.35372771755544785,  0.31967906562345555],
[ 0.11337741174003793,  0.5049072551016909,  0.17797662194869993,  0.20373871120957124],
[ 0.1857111923466722,  0.2665313160128871,  0.23649335403492946,  0.31126413760551125],
[ 0.5115071130993397,  0.08517125025821752,  0.08809229082034653,  0.3152293458220962],
[ 0.3539064685254491,  0.05506890895378577,  0.2457483784636311,  0.34527624405713386]

]

def get_action_variance(action_distributions):
	possible_actions = action_distributions[0].keys()
	variances = {}
	for action in possible_actions:
		action_values = [dist[action] for dist in action_distributions]
		print(action_values)
		variances[action] = np.var(np.array(action_values))
	return variances

def kl_divergences(action_distributions):
	num_dists = len(action_distributions)
	divergence_table = np.zeros((num_dists, num_dists))

	for i in range(num_dists):
		for j in range(num_dists):
			divergence_table[i][j] = kl_divergence(action_distributions[i], action_distributions[j]) + kl_divergence(action_distributions[j], action_distributions[i])

	return divergence_table


def kl_divergence(p, q):
    p = np.asarray(p, dtype=np.float)
    q = np.asarray(q, dtype=np.float)

    return np.sum(np.where(p != 0, p * np.log(p / q), 0))


print(kl_divergences(avg_distributions))
